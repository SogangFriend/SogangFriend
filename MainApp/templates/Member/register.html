{% extends 'yellow_base.html' %}
{% load static %}
{% block inwrap %}
<link rel="stylesheet" href="{% static '/css/register.css' %}">

<div class="white_box">
    <div class="img_register_box">
        <img class="img_register" src="{% static 'images/register.jpg' %}" >
    </div>
    <div class="register">
        <span class="register_h2">
            언택트 시대,<br>친구 어떻게 사귀세요?
        </span>
        <form method = "POST" action = "">
            {% csrf_token %}
            <div class="form-group">
                <br>
                <div class="register_h4">
                    *표시는 필수 사항입니다.
                </div>
                <div class="idForm">
                    <input type="text" class="sinput" id="name" placeholder="*닉네임" name="name">
                    <input type="button" class="sbtn" onclick="id_overlap_check()" value ="중복검사"/input>
                </div>

                <div class="idForm">
                    <input type="number" class="input" id="student_number" placeholder="학번을 입력하면 공개됩니다" name= "student_number">
                </div>

                <div class="idForm">
                    <input type="text" class="input" id="email" placeholder="*서강 이메일" name= "email">
                </div>

                <div class="idForm">
                    <input type="text" class="sinput" id="location" placeholder="*위치를 인증해주세요" name= "location"/>
                    <input type="button" class="sbtn" onclick="coordToAddr()" value="위치 얻기"/>
                </div>

                <div class="idForm">
                    <input type="password" class="input" id="password" placeholder="*비밀번호 (7자 이상 영문자&숫자 조합)" name= "password">
                </div>

                <div class="idForm">
                    <input type= "password" class="input" id="re_password" placeholder="*비밀번호 확인" name = "re_password">
                </div>

                <div class="idForm">
                    <input type="text" class="input" id="introduction" placeholder="간단한 자기소개를 입력해주세요" name= "introduction">
                </div>

                <div class="register_h4">
                    자기소개는 My Page에서 수정 가능합니다.
                </div>
                <br>
                <button id="alertStart" type="submit" class="btn">이메일 인증하고 가입 완료</button>

                <div class="bottomText">
                    이미 회원이신가요? <a href="{% url 'login'%}">  로그인하기</a>
                </div>
            </div>
        </form>
    </div>
</div>


    <script>

    let geocoder = new kakao.maps.services.Geocoder();
    let lat, lng;
        function coordToAddr() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    lat = position.coords.latitude;
                    lng = position.coords.longitude;
                    geocoder.coord2Address(lng, lat, function (result, status) {
                        if (status === kakao.maps.services.Status.OK) {
                            console.log(result);
                            let addr = result[0].address.address_name.split(' ');
                            let GY = ["인천", "부산", "대전", "울산", "광주", "대구"];
                            if (addr[0] === "서울") addr[0] += "특별시";
                            else if (addr[0] === "세종") addr[0] += "특별자치시";
                            else if (addr[0] in GY) addr[0] += "광역시";
                            else addr[0] += "도";
                            addr = addr[0] + " " + addr[1] + " " + addr[2];
                            console.log(addr);
                            document.getElementById("location").value = addr;
                        }
                    });
                }, function (error) {
                    console.error(error);
                }, {
                    enableHighAccuracy: true,
                    maximumAge: 0,
                    timeout: Infinity
                });
            } else {
                alert('GPS NOT SUPPORTED');
            }
        }

        $().ready(function () {
            $("#alertStart").click(function () {
                Swal.fire({
                    icon: 'success',
                    title: '입력하신 이메일로 인증 메일이 전송되었습니다.',
                    text: '메일이 오지 않았을 시 스팸메일함을 확인해 주세요.',
                    confirmButtonColor: '#000000',
                    confirmButtonText: '확인',
                });
            });
        });
    </script>
{% endblock %}
